## Semantic Segmentation using Adversarial Training

Paper Ref :- [Semantic Segmentation using Adversarial Networks](https://arxiv.org/abs/1611.08408)

### Pytorch implementation 

Stanford Background Segmentation dataset is used. There are 8 classes. 
The label maps are one-hot-encodified and compressed and stored in HD5F format.

### Loss functions:

#### Discriminator's Loss 
`
Real_Loss = BinaryCrossEntropyLoss(discriminator(Real_Label_Map), Ones)
`
<br>
`
Fake_Loss = BinaryCrossEntropyLoss(discriminator(Fake_Label_Map), Zeroes)   ## Fake label map =>  generated by the segmentor
`

### Segmentor's Loss 

`
SLoss =  CrossEntropy(Generated, Actual) + Lambda*BinaryCrossEntropyLoss(discriminator(Fake_Label_Map), Ones)
`


Prolonged access to GPU was not available. This was trained for 12 epochs with only 1 image per mini-batch ( lack of high memory GPU ).

### The results are:-

#### Losses: 

##### Discriminator's fake loss

<div align="center">
  <br>
  <img src="after_12_epoch/Dlossfake.png" alt="D_fake_loss">
  <br>
</div>

##### Discriminator's real loss

<div align="center">
  <br>
  <img src="after_12_epoch/Dlossreal.png" alt="D_real_loss">
  <br>
</div>

##### Segmentor's Loss

<div align="center">
  <br>
  <img src="after_12_epoch/GLoss.png" alt="Segmentor Loss">
  <br>
</div>


<div align="center">
  <br>
  <img src="after_12_epoch/orig.png" alt="Original Image" width="400">
  <br>
  <br>
</div>

<div align="center">
	Class 1 :
  <br>
  <img src="after_12_epoch/class1.png" alt="Class 1" >
  <br>
  <br>
</div>

<div align="center">
	Class 2 :
  <br>
  <img src="after_12_epoch/class2.png" alt="Class 2" >
  <br>
  <br>
</div>


<div align="center">
	Class 3 :
  <br>
  <img src="after_12_epoch/class3.png" alt="Class 3" >
  <br>
  <br>
</div>


<div align="center">
	Class 4 :
  <br>
  <img src="after_12_epoch/class4.png" alt="Class 4" >
  <br>
  <br>
</div>

<div align="center">
	Class 5 :
  <br>
  <img src="after_12_epoch/class5.png" alt="Class 5" >
  <br>
  <br>
</div>

<div align="center">
	Class 6 :
  <br>
  <img src="after_12_epoch/class6.png" alt="Class 6" >
  <br>
  <br>
</div>

<div align="center">
	Class 7 :
  <br>
  <img src="after_12_epoch/class7.png" alt="Class 7" >
  <br>
  <br>
</div>

<div align="center">
	Class 8 :
  <br>
  <img src="after_12_epoch/class8.png" alt="Class 8" >
  <br>
  <br>
</div>

